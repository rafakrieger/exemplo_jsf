<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="./principal.xhtml" xmlns:p="http://primefaces.org/ui"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core">

	<ui:define name="conteudo">

		<p:panel id="painel_conteudo" header="Pessoa Física">
			<p:tabView id="tab_view" activeIndex="#{pfisicaC.aba}">
				<p:ajax event="tabChange" listener="#{pfisicaC.onTabChange}"
					update="tab_view:form_novo:profissao" />
				<p:ajax event="tabClose" listener="#{pfisicaC.onTabClose}" />
				<p:tab title="Pesquisa">
					<h:form id="form_pesquisa">
						<p:panelGrid columns="3" layout="flex"
							columnClasses="p-col-12 p-md-3 p-xl-2, p-col-12 p-md-9 p-xl-4, p-col-12 p-md-3 p-xl-2"
							contentStyleClass="ui-fluid">
							<p:outputLabel for="pf" value="Nome:" />
							<p:inputText id="pf" value="#{pfisicaC.pf.nome}" required="true"
								requiredMessage="Nome é obrigatório" />
							<p:commandButton value="Pesquisar" update="tabela pf"
								action="#{pfisicaC.pesquisarPorNome}" />
						</p:panelGrid>

						<p:dataTable id="tabela" var="pessoa"
							value="#{pfisicaC.modelFisicas}" rows="10" paginator="true"
							paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
							currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
							rowsPerPageTemplate="5,10,15,{ShowAll|'All'}">

							<p:column headerText="Nome">
								<h:outputText value="#{pessoa.nome}" />
							</p:column>

							<p:column headerText="E-mail">
								<h:outputText value="#{pessoa.email}" />
							</p:column>

							<p:column headerText="CPF">
								<h:outputText value="#{pessoa.cpf}" />
							</p:column>

							<p:column headerText="Bairro">
								<h:outputText value="#{pessoa.endereco.bairro}" />
							</p:column>

							<p:column headerText="Cidade">
								<h:outputText value="#{pessoa.endereco.localidade}" />
							</p:column>

							<p:column headerText="Alterar / excluir">
								<p:commandButton icon="pi pi-pencil" title="Alterar"
									style="margin-right: 12px"
									styleClass="rounded-button ui-button-outlined" process="@this"
									actionListener="#{pfisicaC.prepAlterar}" update="@all" />
								<p:commandButton icon="pi pi-trash" title="Excluir"
									process="@this" styleClass="rounded-button ui-button-outlined"
									actionListener="#{pfisicaC.excluir}" update="tabela">
									<p:confirm header="Confirmação"
										message="Deseja realmente excluir?" icon="pi pi-info-circle" />
								</p:commandButton>
							</p:column>

						</p:dataTable>

						<p:confirmDialog global="true" showEffect="fade" hideEffect="fade"
							responsive="true" width="350">
							<p:commandButton value="Não" type="button"
								styleClass="ui-confirmdialog-no ui-button-flat" />
							<p:commandButton value="Sim" type="button"
								styleClass="ui-confirmdialog-yes" />
						</p:confirmDialog>

					</h:form>

				</p:tab>

				<p:tab title="Novo">
					<h:form id="form_novo">
						<p:panelGrid columns="4" layout="flex"
							columnClasses="p-col-12 p-md-3 p-xl-2, p-col-12 p-md-9 p-xl-4, p-col-12 p-md-3 p-xl-2, p-col-12 p-md-9 p-xl-4"
							contentStyleClass="p-align-baseline ui-fluid">

							<p:outputLabel for="nome" value="Nome:" />
							<p:inputText id="nome" value="#{pfisicaC.pf.nome}"
								required="true" requiredMessage="Nome é obrigatório" />

							<p:outputLabel for="email" value="E-mail:" />
							<p:inputText id="email" value="#{pfisicaC.pf.email}"
								required="true" requiredMessage="E-mail é obrigatório" />

							<p:outputLabel for="rg" value="RG:" />
							<p:inputText id="rg" value="#{pfisicaC.pf.rg}" required="true"
								requiredMessage="RG é obrigatório" />

							<p:outputLabel for="cpf" value="CPF:" />
							<p:inputMask id="cpf" value="#{pfisicaC.pf.cpf}" required="true"
								requiredMessage="CPF é obrigatório" mask="999.999.999-99" />

							<p:outputLabel for="profissao" value="Profissão:" />
							<p:selectOneMenu id="profissao" value="#{pfisicaC.profissao.id}"
								required="true" requiredMessage="Profissão é obrigatório"
								filter="true" filterMatchMode="startsWith">
								<f:selectItem itemLabel="Escolha uma profissão" itemValue="" />
								<f:selectItems value="#{pfisicaC.comboProfissoes}" />
							</p:selectOneMenu>

							<h:outputLabel value="" />
							<h:outputLabel value="" />

							<p:outputLabel for="cep" value="CEP:" />
							<p:inputMask id="cep" value="#{pfisicaC.endereco.cep}"
								required="true" requiredMessage="CEP é obrigatório" size="10"
								mask="99999-999">
								<p:ajax listener="#{pfisicaC.buscarCep}" event="blur"
									update="rua bairro cidade uf" />

							</p:inputMask>

							<p:outputLabel for="rua" value="Logradouro:" />
							<p:inputText id="rua" value="#{pfisicaC.endereco.logradouro}"
								required="true" requiredMessage="Logradouro é obrigatório" />

							<p:outputLabel for="numero" value="Número:" />
							<p:inputText id="numero" value="#{pfisicaC.endereco.numero}"
								required="true" requiredMessage="Número é obrigatório" />

							<p:outputLabel for="bairro" value="Bairro:" />
							<p:inputText id="bairro" value="#{pfisicaC.endereco.bairro}"
								required="true" requiredMessage="Bairro é obrigatório" />

							<p:outputLabel for="cidade" value="Cidade:" />
							<p:inputText id="cidade" value="#{pfisicaC.endereco.localidade}"
								required="true" requiredMessage="Cidade é obrigatório" />

							<p:outputLabel for="uf" value="Estado:" />
							<p:inputText id="uf" value="#{pfisicaC.endereco.uf}"
								required="true" requiredMessage="UF é obrigatório" />

							<p:outputLabel for="complemento" value="Complemento:" />
							<p:inputText id="complemento"
								value="#{pfisicaC.endereco.complemento}" required="true"
								requiredMessage="Complemento é obrigatório" />

						</p:panelGrid>

						<p:commandButton value="Salvar"
							actionListener="#{pfisicaC.salvar}" update="@all" />

					</h:form>

				</p:tab>

			</p:tabView>
		</p:panel>

	</ui:define>

</ui:composition>